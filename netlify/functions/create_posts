require('dotenv').config();
const {
    DATABASE_URL,
    DATABASE_SECRET
} = process.env;

const { createClient } = grequire('@supabase/supabase-js');
const supabase = createClient(DATABASE_URL, DATABASE_SECRET);
export default {
    data() {
      return {
        posts: {}
      }
    },
    
    methods: {
      async createPost() {
        const {title, content} = this.posts
        if (!title || !content) return
        const user = this.$supabase.auth.user()
        const { data } = await this.$supabase
          .from('posts')
          .insert([
              { id, title, content, user_id: user.id, modified_at }
          ])
          .single()
        this.$router.push(`/posts/${data.id}`)
      }
    }
  }
