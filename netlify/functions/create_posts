// Grab our credentials from a .env file or environment variables
require('dotenv').config();
const {
    DATABASE_URL,
    SUPABASE_SERVICE_API_KEY
} = process.env;

// Connect to our database 
const { createClient } = require('@supabase/supabase-js');
const supabase = createClient(DATABASE_URL, SUPABASE_SERVICE_API_KEY);

// Our standard serverless handler function
exports.handler = async event => {

  // Insert a row
    const { data, error } = await supabase
        .from('posts')
        .insert([
            {id: '2'
            created_at: '17:10'
            title: 'Hello'
            content: 'This is a test'
            modified_at: ''
            user_id: 'DZ'
            },
        ]);

  // Did it work?
  console.log(data, error);
  
}

if (error) {
    return {
      statusCode: 500,
      body: JSON.stringify(error),
    };
  }

  return {
    statusCode: 200,
    body: JSON.stringify(data),
  };
};

// Get everything from the notes table
let { data: posts, error } = await supabase
    .from('posts')
    .select('*')

// Just return the date and note columns of every note 
let { data: posts, error } = await supabase
    .from('posts')
    .select('id, created_at,title, content, modified_at, user_id')
